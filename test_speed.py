import time
import torch
import numpy as np
from ultralytics import YOLO

# --- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ ---
MODEL_PATH = "best.pt"  # ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
IMG_SIZE = 640          # ‡∏Ç‡∏ô‡∏≤‡∏î‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÄ‡∏ó‡∏£‡∏ô (‡∏õ‡∏Å‡∏ï‡∏¥ 640)
TEST_ROUNDS = 50        # ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏ó‡∏™

def benchmark():
    print(f"üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏•: {MODEL_PATH} ...")
    try:
        model = YOLO(MODEL_PATH)
    except Exception as e:
        print("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÇ‡∏°‡πÄ‡∏î‡∏• ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢:", e)
        return

    # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏π‡∏õ‡∏´‡∏•‡∏≠‡∏Å‡πÜ (Dummy Image) ‡∏™‡∏µ‡∏î‡∏≥ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ó‡∏™‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß
    # (‡πÄ‡∏£‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ ‡∏™‡∏ô‡πÅ‡∏Ñ‡πà‡∏Ç‡∏ô‡∏≤‡∏î‡∏£‡∏π‡∏õ ‡∏ß‡πà‡∏≤ AI ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏ó‡∏±‡∏ô‡πÑ‡∏´‡∏°)
    dummy_img = np.zeros((IMG_SIZE, IMG_SIZE, 3), dtype=np.uint8)

    print("\nüî• Warming up (‡∏ß‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á 5 ‡∏£‡∏≠‡∏ö)...")
    for _ in range(5):
        model(dummy_img, verbose=False)

    print(f"üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤ (‡πÄ‡∏ó‡∏™ {TEST_ROUNDS} ‡∏£‡∏≠‡∏ö)...")
    start_time = time.time()
    
    # ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Line 30: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô i ‡πÄ‡∏õ‡πá‡∏ô _ (Unused loop index)
    for _ in range(TEST_ROUNDS):
        # ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Line 31: ‡∏•‡∏ö‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ results (Unused local variable)
        model(dummy_img, verbose=False)
        
    end_time = time.time()
    
    # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ú‡∏•
    total_time = end_time - start_time
    avg_time = total_time / TEST_ROUNDS
    fps = 1 / avg_time

    print("\n" + "="*40)
    # ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Line 41: ‡∏•‡∏ö f ‡∏´‡∏ô‡πâ‡∏≤ string (Useless f-string)
    print("üìä ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß (Speed Benchmark)")
    print("="*40)
    print(f"‚è±Ô∏è  ‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:    {total_time:.4f} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ")
    print(f"‚ö°  ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ï‡πà‡∏≠ 1 ‡∏£‡∏π‡∏õ:    {avg_time*1000:.2f} ms (‡∏°‡∏¥‡∏•‡∏•‡∏¥‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)")
    print(f"üéûÔ∏è  FPS (‡πÄ‡∏ü‡∏£‡∏°‡∏ï‡πà‡∏≠‡∏ß‡∏¥):   {fps:.2f} FPS")
    print("="*40)
    print("‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏±‡∏ß AI (‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏à‡∏≤‡∏Å‡πÄ‡∏ô‡πá‡∏ï)")

if __name__ == "__main__":
    benchmark()